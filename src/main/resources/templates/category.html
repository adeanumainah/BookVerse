<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Categories - BookVerse Admin</title>
    <link rel="stylesheet" th:href="@{/css/category.css}">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
</head>
<body>
    <div class="container">
        <div class="back-btn-wrapper">
            <a th:href="@{/web/admin-dashboard}" class="back-btn">
                <i class="fas fa-arrow-left"></i> Kembali ke Dashboard
            </a>
        </div>
        <header>
            <h1><i class="fas fa-folder"></i> Kelola Kategori</h1>
            <p>Kelola kategori buku agar lebih rapi dan mudah ditemukan oleh pengguna</p>
        </header>

        <section class="form-section">
            <form action="/admin/categories/create" method="post" class="category-form">
                <input type="text" name="name" placeholder="Masukkan nama kategori baru..." required>
                <button type="submit"><i class="fas fa-plus"></i> Tambah Kategori</button>
            </form>
        </section>

        <section class="list-section">
            <h2><i class="fas fa-list"></i> Daftar Kategori</h2>

            <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
            <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
            
            <ul class="category-list" th:if="${not categories.empty}">
                <li th:each="cat : ${categories}">
                    <span th:text="${cat.name}"></span>
                    <div class="category-actions">
                        <!-- Tombol Edit -->
                        <button type="button" class="btn-edit"
                                th:attr="data-id=${cat.id}, data-name=${cat.name}"
                                onclick="openEditModal(this)">
                            <i class="fas fa-edit"></i> Edit
                        </button>

                        <form th:action="@{|/admin/categories/delete/${cat.id}|}" method="post" style="display:inline;">
                            <button type="submit" class="btn-delete"
                                    onclick="return confirm('Yakin hapus kategori ini?')">
                                <i class="fas fa-trash"></i> Hapus
                            </button>
                        </form>
                    </div>
                </li>
            </ul>

            <div id="editModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeEditModal()">&times;</span>
                    <h2>Edit Kategori</h2>
                    <form id="editForm" method="post">
                        <input type="text" id="editName" name="name" required>
                        <button type="submit" class="btn-edit"><i class="fas fa-save"></i> Simpan Perubahan</button>
                    </form>
                </div>
            </div>
            
            <div class="empty-state" th:if="${categories.empty}">
                <i class="fas fa-inbox"></i>
                <p>Belum ada kategori. Tambahkan kategori pertama Anda!</p>
            </div>
        </section>
    </div>

    <script>
    function openEditModal(button) {
        const id = button.getAttribute("data-id");
        const name = button.getAttribute("data-name");

        document.getElementById("editName").value = name;
        document.getElementById("editForm").action = "/admin/categories/" + id + "/update";

        document.getElementById("editModal").style.display = "block";
    }

    function closeEditModal() {
        document.getElementById("editModal").style.display = "none";
    }

    window.onclick = function(event) {
        const modal = document.getElementById("editModal");
        if (event.target === modal) {
            modal.style.display = "none";
        }
    }
    </script>
</body>
</html>
